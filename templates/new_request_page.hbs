{{! ========================================================= }}
{{!  NEW REQUEST PAGE — REPORT AN INCIDENT + BACKGROUND      }}
{{! ========================================================= }}

<div class="incident-background">

  <div class="container-divider"></div>
  <div class="container">
    <div class="sub-nav">
      {{breadcrumbs}}
    </div>

    <!-- Keep the native H1 for a11y/SEO, but hide it visually -->
    <h1 class="sr-only" aria-hidden="true">{{t 'submit_a_request'}}</h1>

    <!-- ▼ Incident banner (now owns the visible H1) -->
    <section class="svc-intro" aria-label="Incident form guidance">
      <div class="svc-intro-content">
        <!-- Left: icon + copy -->
        <div class="svc-intro-head">
          <div class="svc-intro-icon" aria-hidden="true">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.6"/>
              <path d="M12 10.5v6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
              <circle cx="12" cy="7.5" r="1.2" fill="currentColor"/>
            </svg>
          </div>
          <div>
            <!-- Visible, ITIL-aligned page title -->
            <h1 class="svc-intro-title">Report an Incident</h1>
            <p class="svc-intro-desc">
              Use this form to report an <strong>IT service interruption</strong>, reduction in service quality,
              or <strong>security incident</strong> impacting your work. If you need to request access, equipment,
              or software, please use the Service Catalog instead so your request routes to the right team.
            </p>
          </div>
        </div>

        <!-- Right: bottom-right CTA -->
        <div class="svc-intro-cta">
          <span class="svc-intro-inline"><strong>Need to request something instead?</strong></span>
          <a class="svc-btn svc-btn-primary" href="/hc/{{help_center.locale}}/services">Go to Service Catalog</a>
        </div>
      </div>
    </section>
    <!-- ▲ End banner -->

    <div id="main-content" class="form">
      <div id="new-request-form"></div>
    </div>
  </div>

</div>

<style>
  /* Full-page background just for the Incident / New Request page */
  .incident-background {
    background: #020533 url("{{asset 'background.png'}}") no-repeat center top fixed;
    background-size: cover;
    min-height: 100vh;
    width: 100%;
    padding-bottom: 80px;
  }

  /* Visually hide (but keep for screen readers) */
  .sr-only{
    position:absolute !important;
    width:1px; height:1px; padding:0; margin:-1px;
    overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0;
  }

  /* ===== Shared design with Services page ===== */
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');

  :root{
    --ink:#0b1324;
    --muted:#475569;
    --banner-border:#E5ECF5;
    --banner-bg: linear-gradient(180deg,#F8FBFF 0%,#F5F8FC 100%);
    --btn-navy:#0B2577;
    --btn-navy-2:#0D2E8E;
  }

  .svc-intro, .svc-intro * { font-family: 'Poppins', sans-serif !important; }

  /* --- FORCE BUTTON TEXT TO BE WHITE --- */
  .svc-btn-primary,
  .svc-btn-primary *,
  .svc-btn-primary:visited {
    color: #ffffff !important;
    fill: #ffffff !important;
  }

  .svc-intro{ margin:16px 0 26px; }
  .svc-intro-content{
    display:flex; flex-direction:column; gap:14px;
    border:1px solid var(--banner-border);
    border-radius:16px;
    background: var(--banner-bg);
    box-shadow:0 2px 6px rgba(16,24,40,.03);
    padding:18px 20px;
  }
  .svc-intro-head{ display:flex; gap:12px; align-items:flex-start; }
  .svc-intro-icon{
    display:grid; place-items:center; min-width:42px; height:42px; border-radius:999px;
    color:#0B5DFF; background: radial-gradient(100% 100% at 50% 50%, #E8EFFF 0%, #F1F6FF 100%);
    border:1px solid #D7E7FF;
  }
  .svc-intro-title{ margin:0 0 4px; font-size:1.06rem; font-weight:700; color:var(--ink); }
  .svc-intro-desc{ margin:0; color:var(--muted); line-height:1.45; font-size:.95rem; }
  .svc-intro-cta{ display:flex; align-items:center; gap:12px; justify-content:flex-end; flex-wrap:wrap; }
  .svc-intro-inline{ color:var(--muted); font-size:.94rem; }

  .svc-btn{
    display:inline-flex; align-items:center; justify-content:center;
    padding:13px 26px; border-radius:14px; font-weight:700; font-size:1rem;
    text-decoration:none; transition:.25s ease; cursor:pointer;
  }
  .svc-btn-primary{
    background: linear-gradient(135deg,var(--btn-navy),#061B52);
    box-shadow:0 6px 16px rgba(11,37,119,.28);
  }
  .svc-btn-primary:hover{
    transform:translateY(-2px);
    background: linear-gradient(135deg,var(--btn-navy-2),#061746);
    box-shadow:0 8px 24px rgba(11,37,119,.40);
  }

  @media (max-width:720px){
    .svc-intro-cta{ justify-content:flex-start; }
  }

  /* --- Modern inputs --- */
  .form input[type="text"],
  .form .nesty-input,
  .form textarea{
    width:100%;
    border:1px solid #E5ECF5;
    border-radius:12px;
    background:#fff;
    padding:12px 14px;
    transition:box-shadow .2s ease, border-color .2s ease;
    box-sizing:border-box;
  }
  .form input[type="text"]:focus,
  .form .nesty-input:focus,
  .form textarea:focus{
    outline:none;
    border-color:#B9D3FF;
    box-shadow:0 0 0 4px rgba(47,128,237,.12);
  }
</style>

<script type="module">
  import { renderNewRequestForm } from "new-request-form";

  const container = document.getElementById("new-request-form");
  const settings = {{json settings}};
  const props = {
    requestForm: {{json new_request_form}},
    newRequestPath: {{json (page_path 'new_request')}},
    parentId: {{json parent.id}},
    parentIdPath: {{json parent.url}},
    locale: {{json help_center.locale}},
    baseLocale: {{json help_center.base_locale}},
    hasAtMentions: {{json help_center.at_mentions_enabled}},
    userRole: {{json user.role}},
    userId: {{json user.id}},
    brandId: {{json brand.id}},
    organizations: {{json user.organizations}},
    wysiwyg: true,
    answerBotModal: {
      answerBot: {{json answer_bot}},
      hasRequestManagement: {{json help_center.request_management_enabled}},
      isSignedIn: {{json signed_in}},
      helpCenterPath: {{json (page_path 'help_center')}},
      requestsPath: {{json (page_path 'requests')}},
      requestPath: {{json (page_path 'request' id=answer_bot.request_id)}}
    },
  };

  renderNewRequestForm(settings, props, container);

  // Set a proper, ITIL-aligned browser title
  document.title = 'Report an Incident – IT Service Desk';
</script>
